<include file="Public:amaze_css" />

<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->


<div class="am-cf admin-main">

  <div class="admin-content">
    <div class="admin-content-body">
      <div class="am-cf am-padding am-padding-bottom-0">
        <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">医生积分列表</strong> / <small>list</small></div>
      </div>

      <hr>

      <div class="am-g">
        <div class="am-u-sm-12 am-u-md-6">
          <div class="am-btn-toolbar">
            <div class="am-btn-group am-btn-group-xs">
            </div>
          </div>
        </div>
        <div class="am-u-sm-12 am-u-md-4" style="padding-right: 0px">
          <label class="am-u-sm-3 am-form-label">时间</label>

          <div class="am-input-group am-input-group-sm">
            <input id="start_time" name="start_time" type="text" class="am-form-field" placeholder="yyyy-mm-dd" data-am-datepicker required readonly/>
          </div>
        </div>
        <div class="am-u-sm-12 am-u-md-1" style="padding-left: 0px;padding-right: 0px; ">
          至
        </div>
        <div class="am-u-sm-12 am-u-md-3" style="padding-left: 0px">
          <div class="am-input-group am-input-group-sm">
            <input id="end_time" name="end_time" type="text" class="am-form-field" placeholder="yyyy-mm-dd" data-am-datepicker required readonly/>
          </div>

            <!--<a class="btn btn-primary" id="exportExcel"  >导出数据</a>-->
            <!--href="{:U('Admin/Doctor/expUser',array('start_time'=>$start_time,'end_time'=>$end_time))}"-->
        </div>
        <div class="am-u-sm-12 am-u-md-4">
          <div class="am-input-group am-input-group-sm">
            <input type="text" class="am-form-field" id="queryStr" placeholder="可输入姓名搜索">
          <span class="am-input-group-btn">
            <button class="am-btn am-btn-default" type="button" onclick="Jumppage()">搜索</button>
          </span>
             <span class="am-input-group-btn">
            <button class="am-btn am-btn-default" type="button" id="exportExcel">导出数据</button>
          </span>
          </div>
        </div>
      </div>

      <div class="am-g">
        <div class="am-u-sm-12">
          <form class="am-form">
            <div id="tablelist">

            <table class="am-table am-table-striped am-table-hover table-main">
              <thead>
              <tr>
                <!--<th class="table-check"><input type="checkbox" id="inputChooseAll"/></th>-->
                <th class="table-id">ID</th>
                <th class="table-title">银行户名</th>
                <th class="table-type">卡号</th>
                <th class="table-author am-hide-sm-only">开户银行</th>
                <th class="table-author am-hide-sm-only">支行</th>
                <th class="table-date am-hide-sm-only">积分</th>
              </tr>
              </thead>
              <tbody>
              <volist name="data" id="doctor">

              <tr>
                <!--<td><input type="checkbox" value="{$doctor.id}"/></td>-->
                <td>{$doctor.id}</td>
                <td>{$doctor.realname}</td>
                <td>{$doctor.cardasn}</td>
                <td class="am-hide-sm-only">{$doctor.bankname}</td>
                <td class="am-hide-sm-only">{$doctor.subbranch}</td>
                <td class="am-hide-sm-only">{$doctor.value}</td>
              </tr>
              </volist>

              </tbody>
            </table>
              </div>

            <div class="am-cf" id="tableFooter">
              共 {$recordnum} 条记录
              <div class="am-fr">
                <div id="pages">

                <ul class="am-pagination">
                  <li class="am-disabled"><a href="#">«</a></li>
                    <for start="1" end="$pagenum+1" step="1" name="i">
                      <if condition="($i eq 1)">
                        <li class="am-active"><a onclick="Jumppage(this);" href="#">{$i}</a></li>
                        <else />
                        <li><a onclick="Jumppage(this);" href="#">{$i}</a></li>
                      </if>
                    </for>

                  <!--<li><a href="#">2</a></li>-->
                  <!--<li><a href="#">3</a></li>-->
                  <!--<li><a href="#">4</a></li>-->
                  <!--<li><a href="#">5</a></li>-->
                  <li><a href="#">»</a></li>
                </ul>
                  </div>
              </div>
            </div>
            <hr />
            <p>注：.....</p>
          </form>
        </div>

      </div>
    </div>

    <footer class="admin-content-footer">
      <hr>
      <p class="am-padding-left">© 2014 AllMobilize, Inc. Licensed under MIT license.</p>
    </footer>

    <!-- 页码 -->
    <!--<div id="pages">-->
      <!--<for start="1" end="$pagenum" step="1" name="i"> <span><a-->
              <!--onclick="Jumppage({$i});" href="#">{$i}</a></span></for>-->
    <!--</div>-->
    <!-- 内容 -->
    <!--<div id="tablelist">-->
      <!--<table border=1>-->
        <!--<tr>-->
          <!--<td>uid</td>-->
          <!--<td>名称</td>-->
        <!--</tr>-->
        <!--<volist name="data" id="patient">-->
          <!--<tr>-->
            <!--<td>{$patient.id}</td>-->
            <!--<td>{$patient.id}</td>-->
          <!--</tr>-->
        <!--</volist>-->
      <!--</table>-->
    <!--</div>-->

  </div>
  <!-- content end -->
</div>

<a href="#" class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu" data-am-offcanvas="{target: '#admin-offcanvas'}"></a>

<include file="Public:js" />
<script src="{$JS_URL}amazeui.datetimepicker.js"></script>

<script>

  $(function () {
    $('#datetimepicker')
            .datetimepicker()
            .on('changeDate', function (ev) {
              alert(ev.date)
            });
  });



  function Jumppage(page){
    var pagesize = 10;
    var pageNum = 1;
    var url = '__SELF__';
    var start_time = $("#start_time").val()
    var end_time = $("#end_time").val()
    var queryStr = $('#queryStr').val()
    if(page)  pageNum = page.innerHTML;

    if(!start_time){
      alert("请选择开始时间");
      return;
    }

    if(!end_time){
      alert("请选择结束时间");
      return;
    }

    jQuery(".am-active").removeClass("am-active");
    jQuery(page).parent("li").addClass("am-active");

    $("<div></div>").load(url,{start_time:start_time,end_time:end_time,queryStr:queryStr,page:pageNum,pagesize:pagesize},function(){

      var data = $(this).find("#tablelist").html();
      $('#tablelist').html(data);

      if(!page){
        var tableFooter = $(this).find("#tableFooter").html();
        $('#tableFooter').html(tableFooter);
      }

      $(this).remove();
    });
  }


  jQuery("#exportExcel").bind("click", function () {
    var start_time = $("#start_time").val()
    var end_time = $("#end_time").val()
    if (confirm("导出excel?")) {
      window.location.href = "__URL__/expUser?" + "start_time=" + start_time + "&end_time="+end_time;
    }
  })

//  jQuery("#inputChooseAll").on("click", function(){
//    jQuery("form input")
//  })
</script>
